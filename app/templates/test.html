{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block title %}Four Seasons{% endblock %}

{% block page_content %}
    <div class="container">
        <div class="row">
            <div class="col-md-5" style="width: 80%; font-size: 20px;">
                <div class="panel panel-default">
                    <div class="panel-heading">
{#                        {% if question.image %}#}
{#                            <img src={{ question.image }} class="img-responsive" alt="Responsive image">#}
{#                        {% endif %}#}
                        <span id="question_num">{{ id + 1}}</span> /
                        <span id="question_all">{{ question_num }}</span>
                        <span id="question_type" style="visibility:hidden">{{ question_type }}</span>
                        <span id="question_ans" style="visibility:hidden">{{ question.answer }}</span>
                        {% if question.image %}
                            <img src={{ question.image }} class="img-responsive" alt="Responsive image" style="width:100%;">
                        {% endif %}
                        {{ question_t['question'] }}
                    </div>
                    <div class="panel-body">
{#                        <ul style="margin-top: 50px;">#}
{#                            <li>#}
{#                                <label>#}
{#                                    <input name="s_option" value="A" type="radio"> A:{{ question_t['A'] }}#}
{#                                </label>#}
{#                            </li>#}
{#                            <li>#}
{#                                <label>#}
{#                                    <input name="s_option" value="B" type="radio"> B:{{ question_t['B'] }}#}
{#                                </label>#}
{#                            </li>#}
{#                            <li>#}
{#                                <label>#}
{#                                    <input name="s_option" value="B" type="radio"> C:{{ question_t['C'] }}#}
{#                                </label>#}
{#                            </li>#}
{#                            <li>#}
{#                                <label>#}
{#                                    <input name="s_option" value="D" type="radio"> B:{{ question_t['D'] }}#}
{#                                </label>#}
{#                            </li>#}
{#                        </ul>#}
                        <ul style="margin-top: 50px;">
                            <li>
                                <label>
                                    A:{{ question_t['A'] }}
                                </label>
                            </li>
                            <li>
                                <label>
                                    B:{{ question_t['B'] }}
                                </label>
                            </li>
                            <li>
                                <label>
                                    C:{{ question_t['C'] }}
                                </label>
                            </li>
                            <li>
                                <label>
                                    D:{{ question_t['D'] }}
                                </label>
                            </li>
                        </ul>
                        <div class="btn-group btn-group-justified" role="group" aria-label="..." style="margin-top: 50px;">
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-default" id="ans_a">A</button>
                            </div>
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-default" id="ans_b">B</button>
                            </div>
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-default" id="ans_c">C</button>
                            </div>
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-default" id="ans_d">D</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
{#                <div class="btn-group btn-group-justified" role="group" aria-label="..." style="margin-bottom: 50px;">#}
{#                    {% for i in range(1, question_num + 1) %}#}
{#                    <div class="btn-group" role="group">#}
{#                        <button type="button" class="btn btn-default" id="question_button{{ i }}">{{ i }}</button>#}
{#                    </div>#}
{#                    {% endfor %}#}
{#                </div>#}
                <h1>剩余时间</h1>
                    <div class="time-item">
                        <strong id="minute_show">0分</strong>
                        <strong id="second_show">0秒</strong>
                    </div>
                </div>
        </div>
    </div>
{% endblock %}
{% block question_content %}
    <script>
        var ans = $("input[type='radio']:checked").val();
        var question_num = parseInt($('#question_num').text());
        var question_all = parseInt($('#question_all').text());
        var question_type = parseInt($('#question_type').text());
        var question_ans = $('#question_ans').text();
        var question_ok = $('#question_ok');
        var storage = window.localStorage;

        $('#ans_a').on('click', function () {
            storage['ans'] = storage['ans'] + 'A1';
            if (question_num !== question_all) {
                window.location.href = '/test/' + question_type + '/' + question_num;
            } else {
                disable_b();
                save()
            }
        })
        $('#ans_b').on('click', function () {
            storage['ans'] = storage['ans'] + 'B1';
            if (question_num !== question_all) {
                window.location.href = '/test/' + question_type + '/' + question_num;
            } else {
                disable_b();
                save()
            }
        })
        $('#ans_c').on('click', function () {
            storage['ans'] = storage['ans'] + 'C1';
            if (question_num !== question_all) {
                window.location.href = '/test/' + question_type + '/' + question_num;
            } else {
                disable_b();
                save()
            }
        })
        $('#ans_d').on('click', function () {
            storage['ans'] = storage['ans'] + 'D1';
            if (question_num !== question_all) {
                window.location.href = '/test/' + question_type + '/' + question_num;
            } else {
                disable_b();
                save()
            }
        })
        function save() {
            for (var i=question_all - question_num; i >=0; i--){
                storage['ans'] = storage['ans'] + 'E1';
            }
            var answer = storage['ans'];
            console.log(storage['ans']);
            storage.removeItem("ans");
            window.location.href = '/save/'+answer;
        }
        function disable_b() {
            $('#ans_a').attr('disabled', 'disabled');
            $('#ans_b').attr('disabled', 'disabled');
            $('#ans_c').attr('disabled', 'disabled');
            $('#ans_d').attr('disabled', 'disabled');
        }


        var intDiff = parseInt(60);//倒计时总秒数量
        function timer(intDiff){
            window.setInterval(function(){
            var day=0,
                hour=0,
                minute=0,
                second=0;//时间默认值
            if(intDiff > 0){
                day = Math.floor(intDiff / (60 * 60 * 24));
                hour = Math.floor(intDiff / (60 * 60)) - (day * 24);
                minute = Math.floor(intDiff / 60) - (day * 24 * 60) - (hour * 60);
                second = Math.floor(intDiff) - (day * 24 * 60 * 60) - (hour * 60 * 60) - (minute * 60);
            }else{
                alert("时间到,考试结束")
                save()
            }
            if (minute <= 9) minute = '0' + minute;
            if (second <= 9) second = '0' + second;
            $('#day_show').html(day+"天");
            $('#hour_show').html('<s id="h"></s>'+hour+'时');
            $('#minute_show').html('<s></s>'+minute+'分');
            $('#second_show').html('<s></s>'+second+'秒');
            intDiff--;
            }, 1000);
        }
        $(function(){
            timer(intDiff);
        });


    </script>
{% endblock %}
